<!DOCTYPE html>
<html>
<head>
    <title>Gas Bill Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Gas Bill Calculator</h1>
        
        <form id="calculatorForm">
            <div class="mb-3">
                <label>Language</label>
                <select class="form-select" name="language">
                    <option value="en">English</option>
                    <option value="tr">Turkish</option>
                </select>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label>Start Date</label>
                        <input type="date" class="form-control" name="start_date" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label>End Date</label>
                        <input type="date" class="form-control" name="end_date" required>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label>Initial Reading</label>
                        <input type="number" step="0.01" class="form-control" name="first_index" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label>Final Reading</label>
                        <input type="number" step="0.01" class="form-control" name="last_index" required>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Calculate</button>
        </form>

        <div id="results" class="mt-4">
            <!-- Results will be displayed here -->
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#calculatorForm').on('submit', function(e) {
                e.preventDefault(); // Prevent default form submission
                
                // Get form data
                const formData = {
                    language: $('select[name="language"]').val(),
                    start_date: $('input[name="start_date"]').val(),
                    end_date: $('input[name="end_date"]').val(),
                    first_index: parseFloat($('input[name="first_index"]').val()),
                    last_index: parseFloat($('input[name="last_index"]').val())
                };

                // Send POST request to calculate endpoint
                $.ajax({
                    url: '/calculate',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function(response) {
                        if (response.success) {
                            const result = response.result;
                            // Display results
                            $('#results').html(`
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Calculation Results</h5>
                                        <p>Consumption: ${result.consumption_m3.toFixed(2)} m³</p>
                                        <p>Daily Consumption: ${result.daily_consumption_m3.toFixed(2)} m³</p>
                                        <p>Energy Consumed: ${result.energy_consumed_kwh.toFixed(2)} kWh</p>
                                        <p>Daily Cost: ${result.daily_cost.toFixed(2)} ₺</p>
                                        <p>Projected Monthly Cost: ${result.projected_monthly_cost.toFixed(2)} ₺</p>
                                        <p>Total Cost for Period: ${result.total_cost_for_period.toFixed(2)} ₺</p>
                                    </div>
                                </div>
                            `);
                        } else {
                            $('#results').html(`
                                <div class="alert alert-danger">
                                    Error: ${response.error}
                                </div>
                            `);
                        }
                    },
                    error: function(xhr, status, error) {
                        $('#results').html(`
                            <div class="alert alert-danger">
                                An error occurred while calculating. Please try again.
                            </div>
                        `);
                    }
                });
            });
        });
    </script>
</body>
</html> 